<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fastmath.calculus documentation</title><script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Fastmath</span> <span class="project-version">2.3.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fastmath</span></div></div></li><li class="depth-2 branch current"><a href="fastmath.calculus.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>calculus</span></div></a></li><li class="depth-2 branch"><a href="fastmath.clustering.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clustering</span></div></a></li><li class="depth-2 branch"><a href="fastmath.complex.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>complex</span></div></a></li><li class="depth-2 branch"><a href="fastmath.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="fastmath.curves.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>curves</span></div></a></li><li class="depth-2 branch"><a href="fastmath.distance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>distance</span></div></a></li><li class="depth-2 branch"><a href="fastmath.easings.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>easings</span></div></a></li><li class="depth-2 branch"><a href="fastmath.efloat.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>efloat</span></div></a></li><li class="depth-2 branch"><a href="fastmath.fields.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fields</span></div></a></li><li class="depth-2 branch"><a href="fastmath.gp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gp</span></div></a></li><li class="depth-2 branch"><a href="fastmath.grid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>grid</span></div></a></li><li class="depth-2 branch"><a href="fastmath.interpolation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interpolation</span></div></a></li><li class="depth-2 branch"><a href="fastmath.kernel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kernel</span></div></a></li><li class="depth-2 branch"><a href="fastmath.matrix.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>matrix</span></div></a></li><li class="depth-2"><a href="fastmath.optimization.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>optimization</span></div></a></li><li class="depth-3 branch"><a href="fastmath.optimization.bo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bo</span></div></a></li><li class="depth-3"><a href="fastmath.optimization.lbfgsb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lbfgsb</span></div></a></li><li class="depth-2"><a href="fastmath.protocols.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-3"><a href="fastmath.protocols.matrix.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>matrix</span></div></a></li><li class="depth-2 branch"><a href="fastmath.quaternion.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>quaternion</span></div></a></li><li class="depth-2 branch"><a href="fastmath.random.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>random</span></div></a></li><li class="depth-2 branch"><a href="fastmath.signal.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>signal</span></div></a></li><li class="depth-2 branch"><a href="fastmath.solver.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>solver</span></div></a></li><li class="depth-2"><a href="fastmath.stats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stats</span></div></a></li><li class="depth-3"><a href="fastmath.stats.bootstrap.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bootstrap</span></div></a></li><li class="depth-2 branch"><a href="fastmath.transform.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2"><a href="fastmath.vector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fastmath.calculus.html#var-cubature"><div class="inner"><span>cubature</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-derivative"><div class="inner"><span>derivative</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-extrapolate"><div class="inner"><span>extrapolate</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-f.27"><div class="inner"><span>f'</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-f.27.27"><div class="inner"><span>f''</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-f.27.27.27"><div class="inner"><span>f'''</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-fx-.3Egx.2Bh"><div class="inner"><span>fx-&gt;gx+h</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-fx-.3Egx-h"><div class="inner"><span>fx-&gt;gx-h</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-gradient"><div class="inner"><span>gradient</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-hessian"><div class="inner"><span>hessian</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-integrate"><div class="inner"><span>integrate</span></div></a></li><li class="depth-1"><a href="fastmath.calculus.html#var-vegas"><div class="inner"><span>vegas</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fastmath.calculus</h1><div class="doc"><div class="markdown"><p>Integration and derivatives</p>
<p>Integrate univariate and multivariate functions.</p>
<ul>
<li>VEGAS / VEGAS+ - Monte Carlo integration of multivariate function</li>
<li>h-Cubature - h-adaptive integration of multivariate function</li>
<li>Guass-Kronrod and Gauss-Legendre - quadrature integration of univariate functions</li>
<li>Romberg, Simpson, MidPoint and Trapezoid</li>
</ul>
<p>Integrant is substituted in case of improper integration bounds.</p>
<p>Derivatives (finite differences method):</p>
<ul>
<li>derivatives of any degree and any order of accuracy</li>
<li>gradient and hessian for multivariate functions</li>
</ul>
</div><div class="markdown"><h4>Categories</h4><ul></ul><p>Other vars: <a>-&gt;CubatureBox</a> <a>-&gt;QuadGKSegment</a> <a href="fastmath.calculus.html#var-cubature">cubature</a> <a href="fastmath.calculus.html#var-derivative">derivative</a> <a href="fastmath.calculus.html#var-extrapolate">extrapolate</a> <a href="fastmath.calculus.html#var-f.27">f'</a> <a href="fastmath.calculus.html#var-f.27.27">f''</a> <a href="fastmath.calculus.html#var-f.27.27.27">f'''</a> <a href="fastmath.calculus.html#var-fx-.3Egx.2Bh">fx-&gt;gx+h</a> <a href="fastmath.calculus.html#var-fx-.3Egx-h">fx-&gt;gx-h</a> <a href="fastmath.calculus.html#var-gradient">gradient</a> <a href="fastmath.calculus.html#var-hessian">hessian</a> <a href="fastmath.calculus.html#var-integrate">integrate</a> <a href="fastmath.calculus.html#var-vegas">vegas</a></p></div></div><div class="public anchor" id="var-cubature"><h3>cubature</h3><div class="usage"><code>(cubature f lower upper)</code><code>(cubature f lower upper {:keys [rel abs max-evals max-iters initdiv info?], :or {rel 1.0E-7, abs 1.0E-7, max-evals Integer/MAX_VALUE, max-iters 64, initdiv 2, info? false}})</code></div><div class="doc"><div class="markdown"><p>Cubature - h-adaptive integration of multivariate function, n&gt;1 dimensions.</p>
<p>Algorithm uses Genz Malik method.</p>
<p>In each iteration a box with biggest error is subdivided and reevaluated.</p>
<p>Improper integrals with infinite bounds are handled by a substitution.</p>
<p>Arguments:</p>
<ul>
<li><code>f</code> - integrant</li>
<li><code>lower</code> - seq of lower bounds</li>
<li><code>upper</code> - seq of upper bounds</li>
</ul>
<p>Options:</p>
<ul>
<li><code>:initvid</code> - initial subdivision per dimension, default: 2.</li>
<li><code>:max-evals</code> - maximum number of evaluations, default: max integer value.</li>
<li><code>:max-iters</code> - maximum number of iterations, default: 64.</li>
<li><code>:rel</code> - relative error, 1.0e-7</li>
<li><code>:abs</code> - absolute error, 1.0e-7</li>
<li><code>:info?</code> - return full information about integration, default: false</li>
</ul>
<p>Function returns a map containing (if info? is true, returns result otherwise):</p>
<ul>
<li><code>:result</code> - integration value</li>
<li><code>:error</code> - integration error</li>
<li><code>:iterations</code> - number of iterations</li>
<li><code>:evaluations</code> - number of evaluations</li>
<li><code>:subdivisions</code> - final number of boxes</li>
<li><code>:fail?</code> - set to <code>:max-evals</code> or <code>:max-iters</code> when one of the limits has been reached without the convergence.</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L614">view source</a></div></div><div class="public anchor" id="var-derivative"><h3>derivative</h3><div class="usage"><code>(derivative f)</code><code>(derivative f n)</code><code>(derivative f n {:keys [acc h method extrapolate?], :or {acc 2, h 0.0, method :central}})</code></div><div class="doc"><div class="markdown"><p>Create nth derivative of <code>f</code> using finite difference method for given accuracy <code>:acc</code> and step <code>:h</code>.</p>
<p>Returns function.</p>
<p>Arguments:</p>
<ul>
<li><code>n</code> - derivative</li>
<li><code>:acc</code> - order of accuracy (default: 2)</li>
<li><code>:h</code> - step, (default: 0.0, automatic)</li>
<li><code>:method</code> - <code>:central</code> (default), <code>:forward</code> or <code>:backward</code></li>
<li><code>:extrapolate?</code> - creates extrapolated derivative if set to true or a map with <a href="fastmath.calculus.html#var-extrapolate">extrapolate</a> function options</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1179">view source</a></div></div><div class="public anchor" id="var-extrapolate"><h3>extrapolate</h3><div class="usage"><code>(extrapolate g)</code><code>(extrapolate g {:keys [contract power init-h rel abs max-evals tol], :or {contract 0.5, power 1.0, init-h 0.5, abs m/MACHINE-EPSILON, rel (m/sqrt (m/ulp init-h)), max-evals Integer/MAX_VALUE, tol 2.0}})</code></div><div class="doc"><div class="markdown"><p>Richardson extrapolation for given function <code>g=g(x,h)</code>. Returns extrapolated function f(x).</p>
<p>Options:</p>
<ul>
<li><code>:contract</code> - shrinkage factor, default=<code>1/2</code></li>
<li><code>:power</code> - set to <code>2.0</code> for even functions around <code>x0</code>, default <code>1.0</code></li>
<li><code>:init-h</code> - initial step <code>h</code>, default=<code>1/2</code></li>
<li><code>:abs</code> - absolute error, default: machine epsilon</li>
<li><code>:rel</code> - relative error, default: ulp for init-h</li>
<li><code>:tol</code> - tolerance for error, default: <code>2.0</code></li>
<li><code>:max-evals</code> - maximum evaluations, default: maximum integer</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1041">view source</a></div></div><div class="public anchor" id="var-f.27"><h3>f'</h3><div class="usage"><code>(f' f)</code></div><div class="doc"><div class="markdown"><p>First central derivative with order of accuracy 2.</p>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1220">view source</a></div></div><div class="public anchor" id="var-f.27.27"><h3>f''</h3><div class="usage"><code>(f'' f)</code></div><div class="doc"><div class="markdown"><p>Second central derivative with order of accuracy 2.</p>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1221">view source</a></div></div><div class="public anchor" id="var-f.27.27.27"><h3>f'''</h3><div class="usage"><code>(f''' f)</code></div><div class="doc"><div class="markdown"><p>Third central derivative with order of accuracy 2.</p>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1222">view source</a></div></div><div class="public anchor" id="var-fx-.3Egx.2Bh"><h3>fx-&gt;gx+h</h3><div class="usage"><code>(fx-&gt;gx+h f)</code></div><div class="doc"><div class="markdown"><p>Convert f(x) to g(x,h)=f(x+h)</p>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1028">view source</a></div></div><div class="public anchor" id="var-fx-.3Egx-h"><h3>fx-&gt;gx-h</h3><div class="usage"><code>(fx-&gt;gx-h f)</code></div><div class="doc"><div class="markdown"><p>Convert f(x) to g(x,h)=f(x-h)</p>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1034">view source</a></div></div><div class="public anchor" id="var-gradient"><h3>gradient</h3><div class="usage"><code>(gradient f)</code><code>(gradient f {:keys [h acc], :or {h 1.0E-6, acc 2}})</code></div><div class="doc"><div class="markdown"><p>Create first partial derivatives of multivariate function for given accuracy <code>:acc</code> and step <code>:h</code>.</p>
<p>Returns function.</p>
<p>Options:</p>
<ul>
<li><code>:acc</code> - order of accuracy, 2 (default) or 4.</li>
<li><code>:h</code> - step, default <code>1.0e-6</code></li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1224">view source</a></div></div><div class="public anchor" id="var-hessian"><h3>hessian</h3><div class="usage"><code>(hessian f)</code><code>(hessian f {:keys [h], :or {h 0.005}})</code></div><div class="doc"><div class="markdown"><p>Creates function returning Hessian matrix for mulitvariate function <code>f</code> and given <code>:h</code> step (default: <code>5.0e-3</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L1263">view source</a></div></div><div class="public anchor" id="var-integrate"><h3>integrate</h3><div class="usage"><code>(integrate f)</code><code>(integrate f lower upper)</code><code>(integrate f lower upper {:keys [rel abs max-iters min-iters max-evals info? integrator integration-points], :or {rel BaseAbstractUnivariateIntegrator/DEFAULT_RELATIVE_ACCURACY, abs BaseAbstractUnivariateIntegrator/DEFAULT_ABSOLUTE_ACCURACY, min-iters BaseAbstractUnivariateIntegrator/DEFAULT_MIN_ITERATIONS_COUNT, max-evals Integer/MAX_VALUE, integration-points 7, integrator :gauss-kronrod, info? false}, :as options})</code></div><div class="doc"><div class="markdown"><p>Univariate integration.</p>
<p>Improper integrals with infinite bounds are handled by a substitution.</p>
<p>Arguments:</p>
<ul>
<li><code>f</code> - integrant</li>
<li><code>lower</code> - lower bound</li>
<li><code>upper</code> - upper bound</li>
</ul>
<p>Options:</p>
<ul>
<li><code>:integrator</code> - integration algorithm, one of: <code>:romberg</code>, <code>:trapezoid</code>, <code>:midpoint</code>, <code>:simpson</code>, <code>:gauss-legendre</code> and <code>:gauss-kronrod</code> (default).</li>
<li><code>:min-iters</code> - minimum number of iterations (default: 3), not used in <code>:gauss-kronrod</code></li>
<li><code>:max-iters</code> - maximum number of iterations (default: 32 or 64)</li>
<li><code>:max-evals</code> - maximum number of evaluations, (default: maximum integer)</li>
<li><code>:rel</code> - relative error</li>
<li><code>:abs</code> - absolute error</li>
<li><code>:integration-points</code> - number of integration (quadrature) points for <code>:gauss-legendre</code> and <code>:gauss-kronrod</code>, default 7</li>
<li><code>:initdiv</code> - initial number of subdivisions for <code>:gauss-kronrod</code>, default: 1</li>
<li><code>:info?</code> - return full information about integration, default: false</li>
</ul>
<p><code>:gauss-kronrod</code> is h-adaptive implementation</p>
<p>Function returns a map containing (if info? is true, returns result otherwise):</p>
<ul>
<li><code>:result</code> - integration value</li>
<li><code>:error</code> - integration error (<code>:gauss-kronrod</code> only)</li>
<li><code>:iterations</code> - number of iterations</li>
<li><code>:evaluations</code> - number of evaluations</li>
<li><code>:subdivisions</code> - final number of boxes (<code>:gauss-kronrod</code> only)</li>
<li><code>:fail?</code> - set to <code>:max-evals</code> or <code>:max-iters</code> when one of the limits has been reached without the convergence.</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L940">view source</a></div></div><div class="public anchor" id="var-vegas"><h3>vegas</h3><div class="usage"><code>(vegas f lower upper)</code><code>(vegas f lower upper {:keys [max-iters rel abs nevals alpha beta warmup info? record-data?], :or {max-iters 10, rel 5.0E-4, abs 5.0E-4, nevals 10000, beta 0.75, warmup 0, info? false, record-data? false}, :as options})</code></div><div class="doc"><div class="markdown"><p>VEGAS+ - Monte Carlo integration of multivariate function, n&gt;1 dimensions.</p>
<p>Improper integrals with infinite bounds are handled by a substitution.</p>
<p>Arguments:</p>
<ul>
<li><code>f</code> - integrant</li>
<li><code>lower</code> - seq of lower bounds</li>
<li><code>upper</code> - seq of upper bounds</li>
</ul>
<p>Additional options:</p>
<ul>
<li><code>:max-iters</code> - maximum number of iterations, default: 10</li>
<li><code>:nevals</code> - number of evaluations per iteration, default: 10000</li>
<li><code>:nintervals</code> - number of grid intervals per dimension (default: 1000)</li>
<li><code>:nstrats</code> - number of stratifications per dimension (calculated)</li>
<li><code>:warmup</code> - number of warmup iterations (results are used to train stratification and grid spacings, default: 0</li>
<li><code>:alpha</code> - grid refinement parameter, 0.5 slow (default for vegas+), 1.5 moderate/fast (defatult for vegas)</li>
<li><code>:beta</code> - stratification damping parameter for startification adaptation, default: 0.75</li>
<li><code>:rel</code> - relative accuracy, default: 5.0e-4</li>
<li><code>:abs</code> - absolute accuracy, default: 5.0e-4</li>
<li><code>:random-sequence</code> - random sequence used for generating samples: <code>:uniform</code> (default), low-discrepancy sequences: <code>:r2</code>, <code>:sobol</code> and <code>:halton</code>.</li>
<li><code>:jitter</code> - jittering factor for low-discrepancy random sequence, default: 0.75</li>
<li><code>:info?</code> - return full information about integration, default: false</li>
<li><code>:record-data?</code> - stores samples, number of strata, x and dx, default: false (requires, <code>:info?</code> to be set to <code>true</code>)</li>
</ul>
<p>For original VEGAS algorithm set <code>:nstrats</code> to <code>1</code>.</p>
<p><code>:nstrats</code> can be also a list, then each dimension is divided independently according to a given number. If list is lower then number of dimensions, then it’s cycled.</p>
<p>Function returns a map with following keys (if info? is true, returns result otherwise):</p>
<ul>
<li><code>:result</code> - value of integral</li>
<li><code>:iterations</code> - number of iterations (excluding warmup)</li>
<li><code>:sd</code> - standard deviation of results</li>
<li><code>:nintervals</code> - actual grid size</li>
<li><code>:nstrats</code> - number of stratitfications per dimension</li>
<li><code>:nhcubes</code> - number of hypercubes</li>
<li><code>:evaluations</code> - number of function calls</li>
<li><code>:chi2-avg</code> - average of chi2</li>
<li><code>:dof</code> - degrees of freedom</li>
<li><code>:Q</code> - goodness of fit indicator, 1 - very good, &lt;0.25 very poor</li>
<li><code>:data</code> - recorded data (if available)</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/calculus.clj#L320">view source</a></div></div></div></body></html>