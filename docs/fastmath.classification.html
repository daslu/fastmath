<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fastmath.classification documentation</title><script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Fastmath</span> <span class="project-version">1.3.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fastmath</span></div></div></li><li class="depth-2 branch current"><a href="fastmath.classification.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classification</span></div></a></li><li class="depth-2 branch"><a href="fastmath.clustering.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clustering</span></div></a></li><li class="depth-2 branch"><a href="fastmath.complex.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>complex</span></div></a></li><li class="depth-2 branch"><a href="fastmath.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="fastmath.distance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>distance</span></div></a></li><li class="depth-2 branch"><a href="fastmath.easings.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>easings</span></div></a></li><li class="depth-2 branch"><a href="fastmath.fields.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fields</span></div></a></li><li class="depth-2 branch"><a href="fastmath.grid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>grid</span></div></a></li><li class="depth-2 branch"><a href="fastmath.interpolation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interpolation</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kernel</span></div></div></li><li class="depth-3"><a href="fastmath.kernel.mercer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mercer</span></div></a></li><li class="depth-2 branch"><a href="fastmath.random.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>random</span></div></a></li><li class="depth-2 branch"><a href="fastmath.rbf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rbf</span></div></a></li><li class="depth-2 branch"><a href="fastmath.stats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stats</span></div></a></li><li class="depth-2 branch"><a href="fastmath.transform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2"><a href="fastmath.vector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fastmath.classification.html#var-*cross-validation-debug*"><div class="inner"><span>*cross-validation-debug*</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-accuracy"><div class="inner"><span>accuracy</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-activation-functions-list"><div class="inner"><span>activation-functions-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-ada-boost"><div class="inner"><span>ada-boost</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-bayes-models-list"><div class="inner"><span>bayes-models-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-bootstrap"><div class="inner"><span>bootstrap</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-ClassificationProto"><div class="inner"><span>ClassificationProto</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-backend"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>backend</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-data"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-labels"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>labels</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-model-raw"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>model-raw</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-predict"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>predict</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-predict-all"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>predict-all</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-test"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-2"><a href="fastmath.classification.html#var-train"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>train</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-cv"><div class="inner"><span>cv</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-decision-tree"><div class="inner"><span>decision-tree</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-error-functions-list"><div class="inner"><span>error-functions-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-fld"><div class="inner"><span>fld</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-gradient-tree-boost"><div class="inner"><span>gradient-tree-boost</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-knn"><div class="inner"><span>knn</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-lda"><div class="inner"><span>lda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-logistic-regression"><div class="inner"><span>logistic-regression</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-loocv"><div class="inner"><span>loocv</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-multiclass-strtegies-list"><div class="inner"><span>multiclass-strtegies-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-naive-bayes"><div class="inner"><span>naive-bayes</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-neural-net"><div class="inner"><span>neural-net</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-qda"><div class="inner"><span>qda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-random-forest"><div class="inner"><span>random-forest</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-rbf-network"><div class="inner"><span>rbf-network</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-rda"><div class="inner"><span>rda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-split-rules-list"><div class="inner"><span>split-rules-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-svm"><div class="inner"><span>svm</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-validate"><div class="inner"><span>validate</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-xgboost"><div class="inner"><span>xgboost</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fastmath.classification</h1><div class="doc"><div class="markdown"><p>Classification algorithms.</p>
<h3><a href="#input-data" name="input-data"></a>Input data</h3>
<ul>
  <li>features - sequence of sequences of numbers</li>
  <li>categories - sequence of any values</li>
</ul>
<p>When needed you can split input data into training data and test data. Test data are optional.</p>
<h3><a href="#workflow" name="workflow"></a>Workflow</h3>
<ul>
  <li>create and train by calling classifier with parameters, train data and optional test data.</li>
  <li>validate data by calling <a href="fastmath.classification.html#var-test">test</a> or <a href="fastmath.classification.html#var-validate">validate</a>.</li>
  <li>cross validate <a href="fastmath.classification.html#var-cv">cv</a>, <a href="fastmath.classification.html#var-loocv">loocv</a>, <a href="fastmath.classification.html#var-bootstrap">bootstrap</a></li>
  <li>repeat or <a href="fastmath.classification.html#var-predict">predict</a></li>
</ul>
<p>Classifier parameters are map of values specific for given algorithm. Check documentation in backend library to find documentation. Classifier can be retrained using <a href="fastmath.classification.html#var-train">train</a>. New instance will be created.</p>
<h3><a href="#implementation-notes" name="implementation-notes"></a>Implementation notes</h3>
<ul>
  <li>only doubles as input data</li>
  <li>categories can be any type</li>
</ul>
<h3><a href="#smile" name="smile"></a>SMILE</h3>
<p><a href="https://haifengl.github.io/smile/classification.html">documentation</a></p>
<p>What is missed:</p>
<ul>
  <li>other types than doubles (attributes)</li>
  <li>maxent</li>
  <li>Online classifiers</li>
  <li>General Naive Bayes</li>
  <li>SVM</li>
</ul>
<h3><a href="#xgboost" name="xgboost"></a>XGBoost</h3>
<p>XGBoost is backed by <a href="https://gitlab.com/alanmarazzi/clj-boost/tree/master">clj-boost</a>. XGBoost uses only <code>multi:softprob</code> objective currently. See <a href="https://xgboost.readthedocs.io/en/latest/parameter.html#parameters-for-tree-booster">documentation</a> for parameters. By default <code>:early-stopping</code> is set to <code>20</code> and <code>:round</code> is set to <code>10</code>.</p>
<h3><a href="#cross-validation" name="cross-validation"></a>Cross validation</h3>
<p>Currently leave-one-out algorithm is implemented.</p>
<h3><a href="#examples" name="examples"></a>Examples</h3>
<p>Iris database is used.</p></div><div class="markdown"><h4>Categories</h4><ul></ul><p>Other vars: <a href="fastmath.classification.html#var-*cross-validation-debug*">*cross-validation-debug*</a> <a href="fastmath.classification.html#var-accuracy">accuracy</a> <a href="fastmath.classification.html#var-activation-functions-list">activation-functions-list</a> <a href="fastmath.classification.html#var-ada-boost">ada-boost</a> <a href="fastmath.classification.html#var-backend">backend</a> <a href="fastmath.classification.html#var-bayes-models-list">bayes-models-list</a> <a href="fastmath.classification.html#var-bootstrap">bootstrap</a> <a href="fastmath.classification.html#var-cv">cv</a> <a href="fastmath.classification.html#var-data">data</a> <a href="fastmath.classification.html#var-decision-tree">decision-tree</a> <a href="fastmath.classification.html#var-error-functions-list">error-functions-list</a> <a href="fastmath.classification.html#var-fld">fld</a> <a href="fastmath.classification.html#var-gradient-tree-boost">gradient-tree-boost</a> <a href="fastmath.classification.html#var-knn">knn</a> <a href="fastmath.classification.html#var-labels">labels</a> <a href="fastmath.classification.html#var-lda">lda</a> <a href="fastmath.classification.html#var-logistic-regression">logistic-regression</a> <a href="fastmath.classification.html#var-loocv">loocv</a> <a href="fastmath.classification.html#var-model-raw">model-raw</a> <a href="fastmath.classification.html#var-multiclass-strtegies-list">multiclass-strtegies-list</a> <a href="fastmath.classification.html#var-naive-bayes">naive-bayes</a> <a href="fastmath.classification.html#var-neural-net">neural-net</a> <a href="fastmath.classification.html#var-predict">predict</a> <a href="fastmath.classification.html#var-predict-all">predict-all</a> <a href="fastmath.classification.html#var-qda">qda</a> <a href="fastmath.classification.html#var-random-forest">random-forest</a> <a href="fastmath.classification.html#var-rbf-network">rbf-network</a> <a href="fastmath.classification.html#var-rda">rda</a> <a href="fastmath.classification.html#var-split-rules-list">split-rules-list</a> <a href="fastmath.classification.html#var-svm">svm</a> <a href="fastmath.classification.html#var-test">test</a> <a href="fastmath.classification.html#var-train">train</a> <a href="fastmath.classification.html#var-validate">validate</a> <a href="fastmath.classification.html#var-xgboost">xgboost</a></p></div></div><div class="public anchor" id="var-*cross-validation-debug*"><h3>*cross-validation-debug*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>When <code>true</code> provide data used to test.</p></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L363">view source</a></div></div><div class="public anchor" id="var-accuracy"><h3>accuracy</h3><div class="usage"><code>(accuracy t p)</code></div><div class="doc"><div class="markdown"><p>Calculate accuracy for real and predicted sequences.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(accuracy [1 2 3 4 1 2 3 4] [1 2 4 4 2 4 4 3])
;;=&gt; 0.375</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L331">view source</a></div></div><div class="public anchor" id="var-activation-functions-list"><h3>activation-functions-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of activation functions for <a href="fastmath.classification.html#var-neural-net">neural-net</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">activation-functions-list
;;=&gt; (:linear :logistic-sigmoid :soft-max)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L264">view source</a></div></div><div class="public anchor" id="var-ada-boost"><h3>ada-boost</h3><div class="usage"><code>(ada-boost x y)</code><code>(ada-boost params x y)</code><code>(ada-boost x y tx ty)</code><code>(ada-boost {:keys [number-of-trees max-nodes], :or {number-of-trees 500, max-nodes 2}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>ada-boost classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (ada-boost train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 3 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L190">view source</a></div></div><div class="public anchor" id="var-bayes-models-list"><h3>bayes-models-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of <a href="fastmath.classification.html#var-naive-bayes">naive-bayes</a> models.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">bayes-models-list
;;=&gt; (:multinomial :bernoulli :polyaurn)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L244">view source</a></div></div><div class="public anchor" id="var-bootstrap"><h3>bootstrap</h3><div class="usage"><code>(bootstrap model)</code><code>(bootstrap model k)</code></div><div class="doc"><div class="markdown"><p>Perform k-round bootstrap validation.</p>
<p>k defaults to 10</p>
<p>Returns map where <code>:accuracy</code> is average accuracy from every round. <code>:boostrap</code> contains every round statistics.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(select-keys (bootstrap (knn train-data train-labels)) [:accuracy])
;;=&gt; {:accuracy 0.9288997391540716}
(select-keys (bootstrap (fld train-data train-labels)) [:accuracy])
;;=&gt; {:accuracy 0.9659408933460341}
(bootstrap (decision-tree train-data train-labels) 4)
;;=&gt; {:accuracy 0.9155686994639649,
;;=&gt;  :bootstrap {0 {:accuracy 0.9189189189189189},
;;=&gt;              1 {:accuracy 0.9268292682926829},
;;=&gt;              2 {:accuracy 0.9117647058823529},
;;=&gt;              3 {:accuracy 0.9047619047619048}}}
(select-keys (bootstrap (knn train-data train-labels) 500) [:accuracy])
;;=&gt; {:accuracy 0.9306765982465112}
(bootstrap (neural-net {:layers [100 50]} train-data train-labels) 5)
;;=&gt; {:accuracy 0.934058337928307,
;;=&gt;  :bootstrap {0 {:accuracy 0.9210526315789473},
;;=&gt;              1 {:accuracy 0.9459459459459459},
;;=&gt;              2 {:accuracy 0.9487179487179487},
;;=&gt;              3 {:accuracy 0.9722222222222222},
;;=&gt;              4 {:accuracy 0.8823529411764706}}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L399">view source</a></div></div><div class="public anchor" id="var-ClassificationProto"><h3>ClassificationProto</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-backend"><h3>backend</h3><div class="usage"><code>(backend _)</code></div><div class="doc"><div class="markdown"><p>Return name of backend library</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(backend (knn train-data train-labels))
;;=&gt; :smile
(backend (xgboost train-data train-labels))
;;=&gt; :xgboost</code></pre></div></div></div><div class="public anchor" id="var-data"><h3>data</h3><div class="usage"><code>(data _)</code><code>(data _ native?)</code></div><div class="doc"><div class="markdown"><p>Return data. Transformed data for backend libarary are returned when <code>native?</code> is true.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(data (knn [[1 2] [3 2]] [0 1]))
;;=&gt; [[[1 2] [3 2]] [0 1]]
(data (knn [[1 2] [3 2]] [0 1]) true)
;;=&gt; [[[1.0 2.0] [3.0 2.0]] [0 1]]</code></pre></div></div></div><div class="public anchor" id="var-labels"><h3>labels</h3><div class="usage"><code>(labels _)</code></div><div class="doc"><div class="markdown"><p>Return labels.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(labels (knn train-data train-labels))
;;=&gt; ["setosa" "versicolor" "virginica"]</code></pre></div></div></div><div class="public anchor" id="var-model-raw"><h3>model-raw</h3><div class="usage"><code>(model-raw _)</code></div><div class="doc"><div class="markdown"><p>Return trained model as a backend class.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(model-raw (knn train-data train-labels))
;;=&gt; smile.classification.KNN@487cdf22
(model-raw (xgboost train-data train-labels))
;;=&gt; ml.dmlc.xgboost4j.java.Booster@4e9b51d9</code></pre></div></div></div><div class="public anchor" id="var-predict"><h3>predict</h3><div class="usage"><code>(predict _ v)</code><code>(predict _ v posteriori?)</code></div><div class="doc"><div class="markdown"><p>Predict class for given vector. With posteriori probabilities when required.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(predict (knn train-data train-labels) [1 2 3 4])
;;=&gt; virginica
(predict (ada-boost train-data train-labels) [1 2 3 4] true)
;;=&gt; ["virginica"
;;=&gt;  (0.10608109928630871 0.43901524034686706 0.4549036603668243)]</code></pre></div></div></div><div class="public anchor" id="var-predict-all"><h3>predict-all</h3><div class="usage"><code>(predict-all _ vs)</code><code>(predict-all _ v posteriori?)</code></div><div class="doc"><div class="markdown"><p>Predict classes for given sequence of vectors. With posteriori probabilities when required.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(predict-all (knn train-data train-labels) (take 3 test-data))
;;=&gt; ("virginica" "setosa" "virginica")
(predict-all (ada-boost train-data train-labels)
             (take 3 test-data)
             true)
;;=&gt; (["virginica" (0.0 0.46514461012643027 0.5348553898735697)]
;;=&gt;  ["setosa" (0.5246884991578663 0.32554192282792405 0.1497695780142096)]
;;=&gt;  ["virginica" (0.0 0.4485704562688169 0.551429543731183)])</code></pre></div></div></div><div class="public anchor" id="var-test"><h3>test</h3><div class="usage"><code>(test _)</code><code>(test _ tx ty)</code></div><div class="doc"><div class="markdown"><p>Validate data using given model and provided test data. Same as <a href="fastmath.classification.html#var-validate">validate</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Use data provided during training</p></blockquote><pre><code class="hljs clojure">(test (knn train-data train-labels test-data test-labels))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 3 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :prediction ("virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "virginica"),
;;=&gt;  :stats {:accuracy 0.9777777777777777},
;;=&gt;  :truth ("virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "virginica")}</code></pre></div><div><blockquote><p>No test data provided</p></blockquote><pre><code class="hljs clojure">(test (knn train-data train-labels))
;;=&gt; nil</code></pre></div><div><blockquote><p>Test other data</p></blockquote><pre><code class="hljs clojure">(test (knn train-data train-labels)
      [[1 2 3 4] [6 4 3 2]]
      ["setosa" "setosa"])
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([1 2 3 4] [6 4 3 2]),
;;=&gt;            :prediction ("virginica" "versicolor"),
;;=&gt;            :truth ("setosa" "setosa")},
;;=&gt;  :prediction ("virginica" "versicolor"),
;;=&gt;  :stats {:accuracy 0.0},
;;=&gt;  :truth ["setosa" "setosa"]}</code></pre></div></div></div><div class="public anchor" id="var-train"><h3>train</h3><div class="usage"><code>(train _ x y)</code><code>(train _ x y tx ty)</code></div><div class="doc"><div class="markdown"><p>Train another set of data for given classifier. Test data are optional.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Train new data</p></blockquote><pre><code class="hljs clojure">(train (knn train-data train-labels) test-data test-labels)
;;=&gt; fastmath.classification$eval17784$fn$reify__17796@6e3dab60</code></pre></div></div></div></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L69">view source</a></div></div><div class="public anchor" id="var-cv"><h3>cv</h3><div class="usage"><code>(cv model)</code><code>(cv model k)</code></div><div class="doc"><div class="markdown"><p>Cross validation of a classification model.</p>
<p>k defaults to 10% of data count.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(cv (knn train-data train-labels))
;;=&gt; {:accuracy 0.9333333333333333}
(cv (knn train-data train-labels) 100)
;;=&gt; {:accuracy 0.9333333333333333}
(cv (knn train-data train-labels) 4)
;;=&gt; {:accuracy 0.9238095238095237}
(cv (knn train-data train-labels) 1)
;;=&gt; {:accuracy 0.9333333333333333}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L378">view source</a></div></div><div class="public anchor" id="var-decision-tree"><h3>decision-tree</h3><div class="usage"><code>(decision-tree x y)</code><code>(decision-tree params x y)</code><code>(decision-tree x y tx ty)</code><code>(decision-tree {:keys [max-nodes node-size split-rule], :or {max-nodes 100, node-size 1, split-rule :gini}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>decision-tree classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (decision-tree train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.2 2.8 4.8 1.8]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L220">view source</a></div></div><div class="public anchor" id="var-error-functions-list"><h3>error-functions-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of error functions for <a href="fastmath.classification.html#var-neural-net">neural-net</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">error-functions-list
;;=&gt; (:least-mean-squares :cross-entropy)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L258">view source</a></div></div><div class="public anchor" id="var-fld"><h3>fld</h3><div class="usage"><code>(fld x y)</code><code>(fld params x y)</code><code>(fld x y tx ty)</code><code>(fld {:keys [dimensionality tolerance], :or {dimensionality -1, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>fld classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (fld train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.2 2.8 4.8 1.8]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L196">view source</a></div></div><div class="public anchor" id="var-gradient-tree-boost"><h3>gradient-tree-boost</h3><div class="usage"><code>(gradient-tree-boost x y)</code><code>(gradient-tree-boost params x y)</code><code>(gradient-tree-boost x y tx ty)</code><code>(gradient-tree-boost {:keys [number-of-trees shrinkage max-nodes subsample], :or {number-of-trees 500, shrinkage 0.005, max-nodes 6, subsample 0.7}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>gradient-tree-boost classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (gradient-tree-boost train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.2 2.8 4.8 1.8]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L226">view source</a></div></div><div class="public anchor" id="var-knn"><h3>knn</h3><div class="usage"><code>(knn x y)</code><code>(knn params x y)</code><code>(knn x y tx ty)</code><code>(knn {:keys [distance k], :or {distance (EuclideanDistance.), k 1}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>knn classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (knn train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 3 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div><div><blockquote><p>Different distance</p></blockquote><pre><code class="hljs clojure">(let [cl (knn {:distance dist/cosine} train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 0, :data (), :prediction (), :truth ()},
;;=&gt;  :stats {:accuracy 1.0}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L186">view source</a></div></div><div class="public anchor" id="var-lda"><h3>lda</h3><div class="usage"><code>(lda x y)</code><code>(lda params x y)</code><code>(lda x y tx ty)</code><code>(lda {:keys [priori tolerance], :or {priori nil, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>lda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (lda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 6,
;;=&gt;            :data ([6.4 2.7 5.3 1.9]
;;=&gt;                   [6.3 2.5 5 1.9]
;;=&gt;                   [5.7 2.5 5 2]
;;=&gt;                   [7.7 2.6 6.9 2.3]
;;=&gt;                   [6.2 2.8 4.8 1.8]
;;=&gt;                   [6.3 3.3 4.7 1.6]),
;;=&gt;            :prediction ("versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"),
;;=&gt;            :truth ("virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "versicolor")},
;;=&gt;  :stats {:accuracy 0.8666666666666667}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L208">view source</a></div></div><div class="public anchor" id="var-logistic-regression"><h3>logistic-regression</h3><div class="usage"><code>(logistic-regression x y)</code><code>(logistic-regression params x y)</code><code>(logistic-regression x y tx ty)</code><code>(logistic-regression {:keys [lambda tolerance max-iterations], :or {lambda 0.0, tolerance 1.0E-5, max-iterations 500}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>logistic-regression classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (logistic-regression train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 3 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L233">view source</a></div></div><div class="public anchor" id="var-loocv"><h3>loocv</h3><div class="usage"><code>(loocv model)</code></div><div class="doc"><div class="markdown"><p>Leave-one-out cross validation of a classification model.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(loocv (knn train-data train-labels))
;;=&gt; {:accuracy 0.9333333333333333}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L366">view source</a></div></div><div class="public anchor" id="var-multiclass-strtegies-list"><h3>multiclass-strtegies-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of multiclass strategies for <a href="fastmath.classification.html#var-svm">svm</a></p></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L313">view source</a></div></div><div class="public anchor" id="var-naive-bayes"><h3>naive-bayes</h3><div class="usage"><code>(naive-bayes x y)</code><code>(naive-bayes params x y)</code><code>(naive-bayes x y tx ty)</code><code>(naive-bayes {:keys [model priori sigma], :or {model :bernoulli, sigma 1.0}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>naive-bayes classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (naive-bayes train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 35,
;;=&gt;            :data ([6.4 2.7 5.3 1.9]
;;=&gt;                   [5.4 3.7 1.5 0.2]
;;=&gt;                   [6.9 3.1 5.4 2.1]
;;=&gt;                   [4.9 3.1 1.5 0.1]
;;=&gt;                   [6 3 4.8 1.8]
;;=&gt;                   [5.1 3.8 1.6 0.2]
;;=&gt;                   [5 3.5 1.3 0.3]
;;=&gt;                   [5.7 4.4 1.5 0.4]
;;=&gt;                   [6.3 2.5 5 1.9]
;;=&gt;                   [5.2 3.4 1.4 0.2]
;;=&gt;                   [6.9 3.2 5.7 2.3]
;;=&gt;                   [5.3 3.7 1.5 0.2]
;;=&gt;                   [6.1 3 4.9 1.8]
;;=&gt;                   [5.7 2.5 5 2]
;;=&gt;                   [5.1 3.8 1.5 0.3]
;;=&gt;                   [7.7 2.6 6.9 2.3]
;;=&gt;                   [6.4 2.8 5.6 2.2]
;;=&gt;                   [5.2 4.1 1.5 0.1]
;;=&gt;                   [6.5 3 5.2 2]
;;=&gt;                   [6.2 2.8 4.8 1.8]
;;=&gt;                   [5 3.6 1.4 0.2]
;;=&gt;                   [6.7 3 5.2 2.3]
;;=&gt;                   [7.1 3 5.9 2.1]
;;=&gt;                   [4.9 3 1.4 0.2]
;;=&gt;                   [5.8 2.8 5.1 2.4]
;;=&gt;                   [4.9 3.1 1.5 0.1]
;;=&gt;                   [4.4 3 1.3 0.2]
;;=&gt;                   [5.1 3.5 1.4 0.2]
;;=&gt;                   [6.3 3.4 5.6 2.4]
;;=&gt;                   [5 3 1.6 0.2]
;;=&gt;                   [6.3 3.3 6 2.5]
;;=&gt;                   [5.4 3.9 1.3 0.4]
;;=&gt;                   [4.7 3.2 1.3 0.2]
;;=&gt;                   [4.6 3.2 1.4 0.2]
;;=&gt;                   [7.6 3 6.6 2.1]),
;;=&gt;            :prediction ("versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"),
;;=&gt;            :truth ("virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "virginica")},
;;=&gt;  :stats {:accuracy 0.2222222222222222}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L246">view source</a></div></div><div class="public anchor" id="var-neural-net"><h3>neural-net</h3><div class="usage"><code>(neural-net x y)</code><code>(neural-net params x y)</code><code>(neural-net x y tx ty)</code><code>(neural-net {:keys [error-function activation-function layers learning-rate momentum weight-decay number-of-epochs], :or {error-function :cross-entropy, learning-rate 0.1, momentum 0.0, weight-decay 0.0, number-of-epochs 25}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>neural-net classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (neural-net {:layers [100 100]} train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6.9 3.1 4.9 1.5] [6.3 3.3 4.7 1.6]),
;;=&gt;            :prediction ("virginica" "virginica"),
;;=&gt;            :truth ("versicolor" "versicolor")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div><div><blockquote><p>Bad model</p></blockquote><pre><code class="hljs clojure">(let [cl (neural-net {:layers [3 3 3], :number-of-epochs 3}
                     train-data
                     train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 28,
;;=&gt;            :data ([5.4 3.7 1.5 0.2]
;;=&gt;                   [4.9 3.1 1.5 0.1]
;;=&gt;                   [5.1 3.8 1.6 0.2]
;;=&gt;                   [5 3.5 1.3 0.3]
;;=&gt;                   [5.7 4.4 1.5 0.4]
;;=&gt;                   [5.2 3.4 1.4 0.2]
;;=&gt;                   [5.3 3.7 1.5 0.2]
;;=&gt;                   [5.7 3 4.2 1.2]
;;=&gt;                   [5.1 3.8 1.5 0.3]
;;=&gt;                   [5.7 2.8 4.1 1.3]
;;=&gt;                   [6.6 2.9 4.6 1.3]
;;=&gt;                   [6 2.2 4 1]
;;=&gt;                   [5.2 4.1 1.5 0.1]
;;=&gt;                   [5 3.6 1.4 0.2]
;;=&gt;                   [5.7 2.9 4.2 1.3]
;;=&gt;                   [4.9 3 1.4 0.2]
;;=&gt;                   [4.9 3.1 1.5 0.1]
;;=&gt;                   [4.4 3 1.3 0.2]
;;=&gt;                   [5.1 3.5 1.4 0.2]
;;=&gt;                   [5 2.3 3.3 1]
;;=&gt;                   [6.9 3.1 4.9 1.5]
;;=&gt;                   [6.3 3.3 4.7 1.6]
;;=&gt;                   [5 3 1.6 0.2]
;;=&gt;                   [5.6 2.9 3.6 1.3]
;;=&gt;                   [5.5 2.4 3.8 1.1]
;;=&gt;                   [5.4 3.9 1.3 0.4]
;;=&gt;                   [4.7 3.2 1.3 0.2]
;;=&gt;                   [4.6 3.2 1.4 0.2]),
;;=&gt;            :prediction ("virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"),
;;=&gt;            :truth ("setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "versicolor"
;;=&gt;                    "setosa"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "versicolor"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "setosa"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa")},
;;=&gt;  :stats {:accuracy 0.37777777777777777}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L266">view source</a></div></div><div class="public anchor" id="var-qda"><h3>qda</h3><div class="usage"><code>(qda x y)</code><code>(qda params x y)</code><code>(qda x y tx ty)</code><code>(qda {:keys [priori tolerance], :or {priori nil, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>qda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (qda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 0, :data (), :prediction (), :truth ()},
;;=&gt;  :stats {:accuracy 1.0}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L202">view source</a></div></div><div class="public anchor" id="var-random-forest"><h3>random-forest</h3><div class="usage"><code>(random-forest x y)</code><code>(random-forest params x y)</code><code>(random-forest x y tx ty)</code><code>(random-forest {:keys [number-of-trees split-rule mtry node-size max-nodes subsample], :or {number-of-trees 500, split-rule :gini, node-size 1, max-nodes 100, subsample 1.0}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>random-forest classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (random-forest train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.2 2.8 4.8 1.8]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L298">view source</a></div></div><div class="public anchor" id="var-rbf-network"><h3>rbf-network</h3><div class="usage"><code>(rbf-network x y)</code><code>(rbf-network params x y)</code><code>(rbf-network x y tx ty)</code><code>(rbf-network {:keys [distance rbf number-of-basis normalize?], :or {distance dist/euclidean, number-of-basis 10, normalize? false}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>rbf-network classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (rbf-network train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 3 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div><div><blockquote><p>Custom rbfs</p></blockquote><pre><code class="hljs clojure">(let [cl (rbf-network {:rbf (take 5
                                  (cycle [(rbf/rbf :linear)
                                          (rbf/rbf :wendland)]))}
                      train-data
                      train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid
;;=&gt;  {:count 5,
;;=&gt;   :data ([6 3 4.8 1.8]
;;=&gt;          [6.1 3 4.9 1.8]
;;=&gt;          [5.7 2.5 5 2]
;;=&gt;          [6.2 2.8 4.8 1.8]
;;=&gt;          [6.9 3.1 4.9 1.5]),
;;=&gt;   :prediction
;;=&gt;   ("versicolor" "versicolor" "versicolor" "versicolor" "virginica"),
;;=&gt;   :truth
;;=&gt;   ("virginica" "virginica" "virginica" "virginica" "versicolor")},
;;=&gt;  :stats {:accuracy 0.8888888888888888}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L283">view source</a></div></div><div class="public anchor" id="var-rda"><h3>rda</h3><div class="usage"><code>(rda x y)</code><code>(rda params x y)</code><code>(rda x y tx ty)</code><code>(rda {:keys [alpha priori tolerance], :or {alpha 0.9, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>rda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (rda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 0, :data (), :prediction (), :truth ()},
;;=&gt;  :stats {:accuracy 1.0}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L292">view source</a></div></div><div class="public anchor" id="var-split-rules-list"><h3>split-rules-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of split rules for <a href="null">decision tree</a> and <a href="fastmath.classification.html#var-random-forest">random-forest</a></p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">split-rules-list
;;=&gt; (:gini :entropy :classification-error)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L218">view source</a></div></div><div class="public anchor" id="var-svm"><h3>svm</h3><div class="usage"><code>(svm x y)</code><code>(svm params x y)</code><code>(svm x y tx ty)</code><code>(svm {:keys [kernel c-or-cp cn strategy-for-multiclass class-weights tolerance epochs], :or {kernel (mercer/kernel :linear), c-or-cp 1.0, cn 1.0, strategy-for-multiclass :one-vs-one, tolerance 0.001, epochs 2}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>svm classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (svm train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.2 2.8 4.8 1.8]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div><div><blockquote><p>Different kernel</p></blockquote><pre><code class="hljs clojure">(let [cl (svm {:kernel (mercer/kernel :gaussian 1), :epochs 10}
              train-data
              train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.2 2.8 4.8 1.8]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L315">view source</a></div></div><div class="public anchor" id="var-validate"><h3>validate</h3><div class="usage"><code>(validate model)</code><code>(validate model tx ty)</code></div><div class="doc"><div class="markdown"><p>Validate data against trained classifier. Same as <a href="fastmath.classification.html#var-test">test</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Use data provided during training</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels test-data test-labels))
;;=&gt; {:invalid {:count 0, :data (), :prediction (), :truth ()},
;;=&gt;  :prediction ("virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "virginica"),
;;=&gt;  :stats {:accuracy 1.0},
;;=&gt;  :truth ("virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "virginica")}</code></pre></div><div><blockquote><p>No test data provided</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels))
;;=&gt; nil</code></pre></div><div><blockquote><p>Test other data</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels)
          [[1 2 3 4] [6 4 3 2]]
          ["virginica" "setosa"])
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 4 3 2]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("setosa")},
;;=&gt;  :prediction ("virginica" "versicolor"),
;;=&gt;  :stats {:accuracy 0.5},
;;=&gt;  :truth ["virginica" "setosa"]}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L336">view source</a></div></div><div class="public anchor" id="var-xgboost"><h3>xgboost</h3><div class="usage"><code>(xgboost x y)</code><code>(xgboost params x y)</code><code>(xgboost x y tx ty)</code><code>(xgboost xgboost-params x y tx ty)</code></div><div class="doc"><div class="markdown"><p>xgboost classifier. Backend library: xgboost</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (xgboost train-data train-labels test-data test-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.2 2.8 4.8 1.8]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}
(let [cl (xgboost {:params {:eta 0.999,
                            :max_depth 1,
                            :grow_policy "lossguide",
                            :alpha 0.5},
                   :rounds 2}
                  train-data
                  train-labels
                  test-data
                  test-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 0, :data (), :prediction (), :truth ()},
;;=&gt;  :stats {:accuracy 1.0}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L308">view source</a></div></div></div></body></html>