<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fastmath.classification documentation</title><script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Fastmath</span> <span class="project-version">1.3.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fastmath</span></div></div></li><li class="depth-2 branch current"><a href="fastmath.classification.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classification</span></div></a></li><li class="depth-2 branch"><a href="fastmath.clustering.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clustering</span></div></a></li><li class="depth-2 branch"><a href="fastmath.complex.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>complex</span></div></a></li><li class="depth-2 branch"><a href="fastmath.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="fastmath.distance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>distance</span></div></a></li><li class="depth-2 branch"><a href="fastmath.easings.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>easings</span></div></a></li><li class="depth-2 branch"><a href="fastmath.fields.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fields</span></div></a></li><li class="depth-2 branch"><a href="fastmath.grid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>grid</span></div></a></li><li class="depth-2 branch"><a href="fastmath.interpolation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interpolation</span></div></a></li><li class="depth-2 branch"><a href="fastmath.random.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>random</span></div></a></li><li class="depth-2 branch"><a href="fastmath.rbf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rbf</span></div></a></li><li class="depth-2 branch"><a href="fastmath.stats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stats</span></div></a></li><li class="depth-2 branch"><a href="fastmath.transform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2"><a href="fastmath.vector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fastmath.classification.html#var-accuracy"><div class="inner"><span>accuracy</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-activation-functions-list"><div class="inner"><span>activation-functions-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-ada-boost"><div class="inner"><span>ada-boost</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-bayes-models-list"><div class="inner"><span>bayes-models-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-ClassificationProto"><div class="inner"><span>ClassificationProto</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-backend"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>backend</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-data"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-labels"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>labels</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-predict"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>predict</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-predict-all"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>predict-all</span></div></a></li><li class="depth-2 branch"><a href="fastmath.classification.html#var-test"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-2"><a href="fastmath.classification.html#var-train"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>train</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-decision-tree"><div class="inner"><span>decision-tree</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-error-functions-list"><div class="inner"><span>error-functions-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-fld"><div class="inner"><span>fld</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-gradient-tree-boost"><div class="inner"><span>gradient-tree-boost</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-knn"><div class="inner"><span>knn</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-lda"><div class="inner"><span>lda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-logistic-regression"><div class="inner"><span>logistic-regression</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-loocv"><div class="inner"><span>loocv</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-naive-bayes"><div class="inner"><span>naive-bayes</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-neural-net"><div class="inner"><span>neural-net</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-qda"><div class="inner"><span>qda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-random-forest"><div class="inner"><span>random-forest</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-rbf-network"><div class="inner"><span>rbf-network</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-rda"><div class="inner"><span>rda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-split-rules-list"><div class="inner"><span>split-rules-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-validate"><div class="inner"><span>validate</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-xgboost"><div class="inner"><span>xgboost</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fastmath.classification</h1><div class="doc"><div class="markdown"><p>Classification algorithms.</p>
<h3><a href="#input-data" name="input-data"></a>Input data</h3>
<ul>
  <li>features - sequence of sequences of numbers</li>
  <li>categories - sequence of any values</li>
</ul>
<p>When needed you can split input data into training data and test data. Test data are optional.</p>
<h3><a href="#workflow" name="workflow"></a>Workflow</h3>
<ul>
  <li>create and train by calling classifier with parameters, train data and optional test data.</li>
  <li>validate data by calling <a href="fastmath.classification.html#var-test">test</a> or <a href="fastmath.classification.html#var-validate">validate</a>.</li>
  <li>cross validate</li>
  <li>repeat or <a href="fastmath.classification.html#var-predict">predict</a></li>
</ul>
<p>Classifier parameters are map of values specific for given algorithm. Check documentation in backend library to find documentation. Classifier can be retrained using <a href="fastmath.classification.html#var-train">train</a>. New instance will be created.</p>
<h3><a href="#implementation-notes" name="implementation-notes"></a>Implementation notes</h3>
<ul>
  <li>only doubles as input data</li>
  <li>categories can be any type</li>
</ul>
<h3><a href="#smile" name="smile"></a>SMILE</h3>
<p><a href="https://haifengl.github.io/smile/classification.html">documentation</a></p>
<p>What is missed:</p>
<ul>
  <li>other types than doubles (attributes)</li>
  <li>maxent</li>
  <li>Online classifiers</li>
  <li>General Naive Bayes</li>
  <li>SVM</li>
</ul>
<h3><a href="#xgboost" name="xgboost"></a>XGBoost</h3>
<p>XGBoost is backed by <a href="https://gitlab.com/alanmarazzi/clj-boost/tree/master">clj-boost</a>. XGBoost uses only <code>multi:softprob</code> objective currently. See <a href="https://xgboost.readthedocs.io/en/latest/parameter.html#parameters-for-tree-booster">documentation</a> for parameters. By default <code>:early-stopping</code> is set to <code>20</code> and <code>:round</code> is set to <code>10</code>.</p>
<h3><a href="#cross-validation" name="cross-validation"></a>Cross validation</h3>
<p>Currently leave-one-out algorithm is implemented.</p></div><div class="markdown"><h4>Categories</h4><ul></ul><p>Other vars: <a href="fastmath.classification.html#var-accuracy">accuracy</a> <a href="fastmath.classification.html#var-activation-functions-list">activation-functions-list</a> <a href="fastmath.classification.html#var-ada-boost">ada-boost</a> <a href="fastmath.classification.html#var-backend">backend</a> <a href="fastmath.classification.html#var-bayes-models-list">bayes-models-list</a> <a href="fastmath.classification.html#var-data">data</a> <a href="fastmath.classification.html#var-decision-tree">decision-tree</a> <a href="fastmath.classification.html#var-error-functions-list">error-functions-list</a> <a href="fastmath.classification.html#var-fld">fld</a> <a href="fastmath.classification.html#var-gradient-tree-boost">gradient-tree-boost</a> <a href="fastmath.classification.html#var-knn">knn</a> <a href="fastmath.classification.html#var-labels">labels</a> <a href="fastmath.classification.html#var-lda">lda</a> <a href="fastmath.classification.html#var-logistic-regression">logistic-regression</a> <a href="fastmath.classification.html#var-loocv">loocv</a> <a href="fastmath.classification.html#var-naive-bayes">naive-bayes</a> <a href="fastmath.classification.html#var-neural-net">neural-net</a> <a href="fastmath.classification.html#var-predict">predict</a> <a href="fastmath.classification.html#var-predict-all">predict-all</a> <a href="fastmath.classification.html#var-qda">qda</a> <a href="fastmath.classification.html#var-random-forest">random-forest</a> <a href="fastmath.classification.html#var-rbf-network">rbf-network</a> <a href="fastmath.classification.html#var-rda">rda</a> <a href="fastmath.classification.html#var-split-rules-list">split-rules-list</a> <a href="fastmath.classification.html#var-test">test</a> <a href="fastmath.classification.html#var-train">train</a> <a href="fastmath.classification.html#var-validate">validate</a> <a href="fastmath.classification.html#var-xgboost">xgboost</a></p></div></div><div class="public anchor" id="var-accuracy"><h3>accuracy</h3><div class="usage"><code>(accuracy t p)</code></div><div class="doc"><div class="markdown"><p>Calculate accuracy for real and predicted sequences.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(accuracy [1 2 3 4 1 2 3 4] [1 2 4 4 2 4 4 3])
;;=&gt; 0.375</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L302">view source</a></div></div><div class="public anchor" id="var-activation-functions-list"><h3>activation-functions-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of activation functions for <a href="fastmath.classification.html#var-neural-net">neural-net</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">activation-functions-list
;;=&gt; (:linear :logistic-sigmoid :soft-max)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L253">view source</a></div></div><div class="public anchor" id="var-ada-boost"><h3>ada-boost</h3><div class="usage"><code>(ada-boost x y)</code><code>(ada-boost params x y)</code><code>(ada-boost x y tx ty)</code><code>(ada-boost {:keys [number-of-trees max-nodes], :or {number-of-trees 500, max-nodes 2}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>ada-boost classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (ada-boost train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("virginica" "versicolor" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L179">view source</a></div></div><div class="public anchor" id="var-bayes-models-list"><h3>bayes-models-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of <a href="fastmath.classification.html#var-naive-bayes">naive-bayes</a> models.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">bayes-models-list
;;=&gt; (:multinomial :bernoulli :polyaurn)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L233">view source</a></div></div><div class="public anchor" id="var-ClassificationProto"><h3>ClassificationProto</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-backend"><h3>backend</h3><div class="usage"><code>(backend _)</code></div><div class="doc"><div class="markdown"><p>Return name of backend library</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(backend (knn train-data train-labels))
;;=&gt; :smile
(backend (xgboost train-data train-labels))
;;=&gt; :xgboost</code></pre></div></div></div><div class="public anchor" id="var-data"><h3>data</h3><div class="usage"><code>(data _)</code><code>(data _ native?)</code></div><div class="doc"><div class="markdown"><p>Return data. Transformed data for backend libarary are returned when <code>native?</code> is true.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(data (knn [[1 2] [3 2]] [0 1]))
;;=&gt; [[[1 2] [3 2]] [0 1]]
(data (knn [[1 2] [3 2]] [0 1]) true)
;;=&gt; [[[1.0 2.0] [3.0 2.0]] [0 1]]</code></pre></div></div></div><div class="public anchor" id="var-labels"><h3>labels</h3><div class="usage"><code>(labels _)</code></div><div class="doc"><div class="markdown"><p>Return labels.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(labels (knn train-data train-labels))
;;=&gt; ["setosa" "versicolor" "virginica"]</code></pre></div></div></div><div class="public anchor" id="var-predict"><h3>predict</h3><div class="usage"><code>(predict _ v)</code><code>(predict _ v posteriori?)</code></div><div class="doc"><div class="markdown"><p>Predict class for given vector. With posteriori probabilities when required.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(predict (knn train-data train-labels) [1 2 3 4])
;;=&gt; virginica
(predict (ada-boost train-data train-labels) [1 2 3 4] true)
;;=&gt; ["virginica"
;;=&gt;  (0.2509664486316904 0.36204584231182024 0.3869877090564894)]</code></pre></div></div></div><div class="public anchor" id="var-predict-all"><h3>predict-all</h3><div class="usage"><code>(predict-all _ vs)</code><code>(predict-all _ v posteriori?)</code></div><div class="doc"><div class="markdown"><p>Predict classes for given sequence of vectors. With posteriori probabilities when required.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(predict-all (knn train-data train-labels) (take 3 test-data))
;;=&gt; ("setosa" "versicolor" "versicolor")
(predict-all (ada-boost train-data train-labels)
             (take 3 test-data)
             true)
;;=&gt; (["setosa" (0.5432454122870903 0.3446600242622353 0.11209456345067426)]
;;=&gt;  ["versicolor"
;;=&gt;   (0.0038837179673066793 0.542470375084628 0.4536459069480653)]
;;=&gt;  ["versicolor"
;;=&gt;   (0.030541880754284673 0.5735056137169295 0.3959525055287857)])</code></pre></div></div></div><div class="public anchor" id="var-test"><h3>test</h3><div class="usage"><code>(test _)</code><code>(test _ tx ty)</code></div><div class="doc"><div class="markdown"><p>Validate data using given model and provided test data. Same as <a href="fastmath.classification.html#var-validate">validate</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Use data provided during training</p></blockquote><pre><code class="hljs clojure">(test (knn train-data train-labels test-data test-labels))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8]),
;;=&gt;            :prediction ("virginica" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica")},
;;=&gt;  :prediction ("setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"),
;;=&gt;  :stats {:accuracy 0.9555555555555556},
;;=&gt;  :truth ("setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor")}</code></pre></div><div><blockquote><p>No test data provided</p></blockquote><pre><code class="hljs clojure">(test (knn train-data train-labels))
;;=&gt; nil</code></pre></div><div><blockquote><p>Test other data</p></blockquote><pre><code class="hljs clojure">(test (knn train-data train-labels)
      [[1 2 3 4] [6 4 3 2]]
      ["setosa" "setosa"])
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([1 2 3 4] [6 4 3 2]),
;;=&gt;            :prediction ("setosa" "setosa"),
;;=&gt;            :truth ("virginica" "versicolor")},
;;=&gt;  :prediction ("virginica" "versicolor"),
;;=&gt;  :stats {:accuracy 0.0},
;;=&gt;  :truth ["setosa" "setosa"]}</code></pre></div></div></div><div class="public anchor" id="var-train"><h3>train</h3><div class="usage"><code>(train _ x y)</code><code>(train _ x y tx ty)</code></div><div class="doc"><div class="markdown"><p>Train another set of data for given classifier. Test data are optional.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Train new data</p></blockquote><pre><code class="hljs clojure">(train (knn train-data train-labels) test-data test-labels)
;;=&gt; fastmath.classification$eval17582$fn$reify__17594@39ccea5e</code></pre></div></div></div></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L61">view source</a></div></div><div class="public anchor" id="var-decision-tree"><h3>decision-tree</h3><div class="usage"><code>(decision-tree x y)</code><code>(decision-tree params x y)</code><code>(decision-tree x y tx ty)</code><code>(decision-tree {:keys [max-nodes node-size split-rule], :or {max-nodes 100, node-size 1, split-rule :gini}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>decision-tree classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (decision-tree train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("virginica" "versicolor" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L209">view source</a></div></div><div class="public anchor" id="var-error-functions-list"><h3>error-functions-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of error functions for <a href="fastmath.classification.html#var-neural-net">neural-net</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">error-functions-list
;;=&gt; (:least-mean-squares :cross-entropy)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L247">view source</a></div></div><div class="public anchor" id="var-fld"><h3>fld</h3><div class="usage"><code>(fld x y)</code><code>(fld params x y)</code><code>(fld x y tx ty)</code><code>(fld {:keys [dimensionality tolerance], :or {dimensionality -1, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>fld classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (fld train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L185">view source</a></div></div><div class="public anchor" id="var-gradient-tree-boost"><h3>gradient-tree-boost</h3><div class="usage"><code>(gradient-tree-boost x y)</code><code>(gradient-tree-boost params x y)</code><code>(gradient-tree-boost x y tx ty)</code><code>(gradient-tree-boost {:keys [number-of-trees shrinkage max-nodes subsample], :or {number-of-trees 500, shrinkage 0.005, max-nodes 6, subsample 0.7}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>gradient-tree-boost classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (gradient-tree-boost train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("virginica" "versicolor" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L215">view source</a></div></div><div class="public anchor" id="var-knn"><h3>knn</h3><div class="usage"><code>(knn x y)</code><code>(knn params x y)</code><code>(knn x y tx ty)</code><code>(knn {:keys [distance k], :or {distance (EuclideanDistance.), k 1}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>knn classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (knn train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8]),
;;=&gt;            :prediction ("virginica" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div><div><blockquote><p>Different distance </p></blockquote><pre><code class="hljs clojure">(let [cl (knn {:distance dist/cosine} train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6.5 3 5.5 1.8]),
;;=&gt;            :prediction ("virginica"),
;;=&gt;            :truth ("versicolor")},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L175">view source</a></div></div><div class="public anchor" id="var-lda"><h3>lda</h3><div class="usage"><code>(lda x y)</code><code>(lda params x y)</code><code>(lda x y tx ty)</code><code>(lda {:keys [priori tolerance], :or {priori nil, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>lda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (lda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 7,
;;=&gt;            :data ([6.7 3.1 4.7 1.5]
;;=&gt;                   [6 2.2 5 1.5]
;;=&gt;                   [7 3.2 4.7 1.4]
;;=&gt;                   [7.7 2.8 6.7 2]
;;=&gt;                   [6.7 3.1 4.4 1.4]
;;=&gt;                   [5.9 3.2 4.8 1.8]
;;=&gt;                   [6.7 3 5 1.7]),
;;=&gt;            :prediction ("versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"),
;;=&gt;            :truth ("virginica"
;;=&gt;                    "versicolor"
;;=&gt;                    "virginica"
;;=&gt;                    "versicolor"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica"
;;=&gt;                    "virginica")},
;;=&gt;  :stats {:accuracy 0.8444444444444443}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L197">view source</a></div></div><div class="public anchor" id="var-logistic-regression"><h3>logistic-regression</h3><div class="usage"><code>(logistic-regression x y)</code><code>(logistic-regression params x y)</code><code>(logistic-regression x y tx ty)</code><code>(logistic-regression {:keys [lambda tolerance max-iterations], :or {lambda 0.0, tolerance 1.0E-5, max-iterations 500}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>logistic-regression classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (logistic-regression train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("virginica" "versicolor" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L222">view source</a></div></div><div class="public anchor" id="var-loocv"><h3>loocv</h3><div class="usage"><code>(loocv model)</code></div><div class="doc"><div class="markdown"><p>Leave-one-out cross validation of a classification model.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(:stats (loocv (knn train-data train-labels)))
;;=&gt; {:accuracy 0.9619047619047619}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L326">view source</a></div></div><div class="public anchor" id="var-naive-bayes"><h3>naive-bayes</h3><div class="usage"><code>(naive-bayes x y)</code><code>(naive-bayes params x y)</code><code>(naive-bayes x y tx ty)</code><code>(naive-bayes {:keys [model priori sigma], :or {model :bernoulli, sigma 1.0}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>naive-bayes classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (naive-bayes train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 36,
;;=&gt;            :data ([6.7 3.1 4.7 1.5]
;;=&gt;                   [5.8 2.7 4.1 1]
;;=&gt;                   [6 2.2 5 1.5]
;;=&gt;                   [6.5 3 5.5 1.8]
;;=&gt;                   [6.3 2.7 4.9 1.8]
;;=&gt;                   [7 3.2 4.7 1.4]
;;=&gt;                   [5.7 2.8 4.1 1.3]
;;=&gt;                   [5.5 2.4 3.8 1.1]
;;=&gt;                   [7.7 2.6 6.9 2.3]
;;=&gt;                   [5.5 2.6 4.4 1.2]
;;=&gt;                   [6.7 3.1 5.6 2.4]
;;=&gt;                   [7.7 3.8 6.7 2.2]
;;=&gt;                   [5.7 2.5 5 2]
;;=&gt;                   [5.1 2.5 3 1.1]
;;=&gt;                   [7.7 2.8 6.7 2]
;;=&gt;                   [6.7 3.1 4.4 1.4]
;;=&gt;                   [6.8 3.2 5.9 2.3]
;;=&gt;                   [5.9 3.2 4.8 1.8]
;;=&gt;                   [6.5 2.8 4.6 1.5]
;;=&gt;                   [6.5 3 5.8 2.2]
;;=&gt;                   [6 2.9 4.5 1.5]
;;=&gt;                   [5.5 2.5 4 1.3]
;;=&gt;                   [5.5 2.4 3.7 1]
;;=&gt;                   [5.6 2.5 3.9 1.1]
;;=&gt;                   [6.3 3.3 6 2.5]
;;=&gt;                   [6.6 3 4.4 1.4]
;;=&gt;                   [7.2 3.2 6 1.8]
;;=&gt;                   [6.7 3 5.2 2.3]
;;=&gt;                   [6.4 2.8 5.6 2.1]
;;=&gt;                   [6.1 3 4.6 1.4]
;;=&gt;                   [7.2 3.6 6.1 2.5]
;;=&gt;                   [6.7 3 5 1.7]
;;=&gt;                   [6.2 2.2 4.5 1.5]
;;=&gt;                   [5 2 3.5 1]
;;=&gt;                   [6.3 2.5 5 1.9]
;;=&gt;                   [6.1 2.9 4.7 1.4]),
;;=&gt;            :prediction ("versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"),
;;=&gt;            :truth ("setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa")},
;;=&gt;  :stats {:accuracy 0.19999999999999996}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L235">view source</a></div></div><div class="public anchor" id="var-neural-net"><h3>neural-net</h3><div class="usage"><code>(neural-net x y)</code><code>(neural-net params x y)</code><code>(neural-net x y tx ty)</code><code>(neural-net {:keys [error-function activation-function layers learning-rate momentum weight-decay number-of-epochs], :or {error-function :cross-entropy, learning-rate 0.1, momentum 0.0, weight-decay 0.0, number-of-epochs 25}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>neural-net classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (neural-net {:layers [100 100]} train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 7,
;;=&gt;            :data ([6 2.2 5 1.5]
;;=&gt;                   [6.5 3 5.5 1.8]
;;=&gt;                   [6.3 2.7 4.9 1.8]
;;=&gt;                   [5.1 2.5 3 1.1]
;;=&gt;                   [7.2 3.2 6 1.8]
;;=&gt;                   [6.7 3 5.2 2.3]
;;=&gt;                   [6.3 2.5 5 1.9]),
;;=&gt;            :prediction ("virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"),
;;=&gt;            :truth ("versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "setosa"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor"
;;=&gt;                    "versicolor")},
;;=&gt;  :stats {:accuracy 0.8444444444444443}}</code></pre></div><div><blockquote><p>Bad model</p></blockquote><pre><code class="hljs clojure">(let [cl (neural-net {:layers [3 3 3], :number-of-epochs 3}
                     train-data
                     train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 36,
;;=&gt;            :data ([6.7 3.1 4.7 1.5]
;;=&gt;                   [5.8 2.7 4.1 1]
;;=&gt;                   [6 2.2 5 1.5]
;;=&gt;                   [6.5 3 5.5 1.8]
;;=&gt;                   [6.3 2.7 4.9 1.8]
;;=&gt;                   [7 3.2 4.7 1.4]
;;=&gt;                   [5.7 2.8 4.1 1.3]
;;=&gt;                   [5.5 2.4 3.8 1.1]
;;=&gt;                   [7.7 2.6 6.9 2.3]
;;=&gt;                   [5.5 2.6 4.4 1.2]
;;=&gt;                   [6.7 3.1 5.6 2.4]
;;=&gt;                   [7.7 3.8 6.7 2.2]
;;=&gt;                   [5.7 2.5 5 2]
;;=&gt;                   [5.1 2.5 3 1.1]
;;=&gt;                   [7.7 2.8 6.7 2]
;;=&gt;                   [6.7 3.1 4.4 1.4]
;;=&gt;                   [6.8 3.2 5.9 2.3]
;;=&gt;                   [5.9 3.2 4.8 1.8]
;;=&gt;                   [6.5 2.8 4.6 1.5]
;;=&gt;                   [6.5 3 5.8 2.2]
;;=&gt;                   [6 2.9 4.5 1.5]
;;=&gt;                   [5.5 2.5 4 1.3]
;;=&gt;                   [5.5 2.4 3.7 1]
;;=&gt;                   [5.6 2.5 3.9 1.1]
;;=&gt;                   [6.3 3.3 6 2.5]
;;=&gt;                   [6.6 3 4.4 1.4]
;;=&gt;                   [7.2 3.2 6 1.8]
;;=&gt;                   [6.7 3 5.2 2.3]
;;=&gt;                   [6.4 2.8 5.6 2.1]
;;=&gt;                   [6.1 3 4.6 1.4]
;;=&gt;                   [7.2 3.6 6.1 2.5]
;;=&gt;                   [6.7 3 5 1.7]
;;=&gt;                   [6.2 2.2 4.5 1.5]
;;=&gt;                   [5 2 3.5 1]
;;=&gt;                   [6.3 2.5 5 1.9]
;;=&gt;                   [6.1 2.9 4.7 1.4]),
;;=&gt;            :prediction ("versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "versicolor"
;;=&gt;                         "virginica"
;;=&gt;                         "versicolor"),
;;=&gt;            :truth ("setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa"
;;=&gt;                    "setosa")},
;;=&gt;  :stats {:accuracy 0.19999999999999996}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L255">view source</a></div></div><div class="public anchor" id="var-qda"><h3>qda</h3><div class="usage"><code>(qda x y)</code><code>(qda params x y)</code><code>(qda x y tx ty)</code><code>(qda {:keys [priori tolerance], :or {priori nil, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>qda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (qda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([5.9 3.2 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L191">view source</a></div></div><div class="public anchor" id="var-random-forest"><h3>random-forest</h3><div class="usage"><code>(random-forest x y)</code><code>(random-forest params x y)</code><code>(random-forest x y tx ty)</code><code>(random-forest {:keys [number-of-trees split-rule mtry node-size max-nodes subsample], :or {number-of-trees 500, split-rule :gini, node-size 1, max-nodes 100, subsample 1.0}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>random-forest classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (random-forest train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("virginica" "versicolor" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L287">view source</a></div></div><div class="public anchor" id="var-rbf-network"><h3>rbf-network</h3><div class="usage"><code>(rbf-network x y)</code><code>(rbf-network params x y)</code><code>(rbf-network x y tx ty)</code><code>(rbf-network {:keys [distance rbf number-of-basis normalize?], :or {distance dist/euclidean, number-of-basis 10, normalize? false}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>rbf-network classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (rbf-network train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([5.9 3.2 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div><div><blockquote><p>Custom rbfs</p></blockquote><pre><code class="hljs clojure">(let [cl (rbf-network {:rbf (take 5
                                  (cycle [(rbf/rbf :linear)
                                          (rbf/rbf :wendland)]))}
                      train-data
                      train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid
;;=&gt;  {:count 5,
;;=&gt;   :data ([6.7 3.1 4.7 1.5]
;;=&gt;          [7 3.2 4.7 1.4]
;;=&gt;          [5.9 3.2 4.8 1.8]
;;=&gt;          [6.5 2.8 4.6 1.5]
;;=&gt;          [6.7 3 5 1.7]),
;;=&gt;   :prediction
;;=&gt;   ("versicolor" "versicolor" "versicolor" "versicolor" "versicolor"),
;;=&gt;   :truth ("virginica" "virginica" "virginica" "virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.8888888888888888}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L272">view source</a></div></div><div class="public anchor" id="var-rda"><h3>rda</h3><div class="usage"><code>(rda x y)</code><code>(rda params x y)</code><code>(rda x y tx ty)</code><code>(rda {:keys [alpha priori tolerance], :or {alpha 0.9, tolerance 1.0E-4}} x y tx ty)</code></div><div class="doc"><div class="markdown"><p>rda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (rda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 2.2 5 1.5] [5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("virginica" "versicolor" "versicolor"),
;;=&gt;            :truth ("versicolor" "virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L281">view source</a></div></div><div class="public anchor" id="var-split-rules-list"><h3>split-rules-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of split rules for <a href="null">decision tree</a> and <a href="fastmath.classification.html#var-random-forest">random-forest</a></p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">split-rules-list
;;=&gt; (:gini :entropy :classification-error)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L207">view source</a></div></div><div class="public anchor" id="var-validate"><h3>validate</h3><div class="usage"><code>(validate model)</code><code>(validate model tx ty)</code></div><div class="doc"><div class="markdown"><p>Validate data against trained classifier. Same as <a href="fastmath.classification.html#var-test">test</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Use data provided during training</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels test-data test-labels))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([5.9 3.2 4.8 1.8]),
;;=&gt;            :prediction ("versicolor"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :prediction ("setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "virginica"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"
;;=&gt;               "versicolor"
;;=&gt;               "setosa"
;;=&gt;               "versicolor"
;;=&gt;               "virginica"
;;=&gt;               "versicolor"),
;;=&gt;  :stats {:accuracy 0.9777777777777777},
;;=&gt;  :truth ("setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "virginica"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor"
;;=&gt;          "versicolor"
;;=&gt;          "setosa"
;;=&gt;          "versicolor"
;;=&gt;          "virginica"
;;=&gt;          "versicolor")}</code></pre></div><div><blockquote><p>No test data provided</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels))
;;=&gt; nil</code></pre></div><div><blockquote><p>Test other data</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels)
          [[1 2 3 4] [6 4 3 2]]
          ["virginica" "setosa"])
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 4 3 2]),
;;=&gt;            :prediction ("setosa"),
;;=&gt;            :truth ("virginica")},
;;=&gt;  :prediction ("virginica" "virginica"),
;;=&gt;  :stats {:accuracy 0.5},
;;=&gt;  :truth ["virginica" "setosa"]}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L307">view source</a></div></div><div class="public anchor" id="var-xgboost"><h3>xgboost</h3><div class="usage"><code>(xgboost x y)</code><code>(xgboost params x y)</code><code>(xgboost x y tx ty)</code><code>(xgboost xgboost-params x y tx ty)</code></div><div class="doc"><div class="markdown"><p>xgboost classifier. Backend library: xgboost</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (xgboost train-data train-labels test-data test-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}
(let [cl (xgboost {:params {:eta 0.999,
                            :max_depth 1,
                            :grow_policy "lossguide",
                            :alpha 0.5},
                   :rounds 2}
                  train-data
                  train-labels
                  test-data
                  test-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([5.9 3.2 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction ("versicolor" "versicolor"),
;;=&gt;            :truth ("virginica" "virginica")},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L297">view source</a></div></div></div></body></html>